webpackJsonp([10],{fB4o:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});r("pw1w");var o=r("OS1Z"),a=r("BTaQ"),n=r("gyMJ"),i={components:{mavonEditor:o.mavonEditor,Form:a.Form,FormItem:a.FormItem,Button:a.Button,Col:a.Col,Row:a.Row,CheckboxGroup:a.CheckboxGroup,Checkbox:a.Checkbox,RadioGroup:a.RadioGroup,Radio:a.Radio,DatePicker:a.DatePicker,TimePicker:a.TimePicker,Select:a.Select,Option:a.Option,Input:a.Input},data:function(){return{formItem:{id:"",title:"",category_id:0,status:99,tag:[],date:new Date,time:new Date,create_time:[],markdown:"",content:""},ruleInline:{title:[{required:!0,message:"文章标题必须填写"}]},category:[],tag:[]}},methods:{post:function(){var t=this;this.formItem.content=this.$refs.md.d_render;var e=this.formItem.date.getMonth()+1,r=this.formItem.date.getDate();e>=1&&e<=9&&(e="0"+e),r>=0&&r<=9&&(r="0"+r),this.formItem.create_time=this.formItem.date.getFullYear()+"-"+e+"-"+r+" "+this.formItem.date.getHours()+":"+this.formItem.date.getMinutes()+":"+this.formItem.date.getSeconds(),this.formItem.type="page",this.$refs.formItem.validate(function(e){e?t.formItem.id?n.d.update(t.formItem.id,t.formItem).then(function(e){0==e.errno&&e.data.id&&t.$router.push("/content/list")}):n.d.create(t.formItem).then(function(e){0==e.errno&&e.data.id&&t.$router.push("/content/list")}):t.$Message.error("请填写必要信息")})},getCategory:function(){var t=this;n.a.getList().then(function(e){t.category=e.data})},getTag:function(){var t=this;n.g.getList().then(function(e){t.tag=e.data})},get:function(t){var e=this;n.d.getInfo(t).then(function(t){var r=[];for(var o in t.data.tag)r.push(t.data.tag[o].id);t.data.tag=r,t.data.date=new Date(1e3*t.data.create_time),t.data.time=new Date(1e3*t.data.create_time),e.formItem=t.data})},imgAdd:function(t,e){var r=this,o=new FormData;o.append("image",e),n.f.upload(o).then(function(e){0==e.errno&&e.data.url&&r.$refs.md.$img2Url(t,e.data.url)})}},mounted:function(){this.$route.query.slug&&this.get(this.$route.query.slug),this.getCategory(),this.getTag()}},m={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Form",{ref:"formItem",attrs:{model:t.formItem,rules:t.ruleInline,"label-width":80}},[r("FormItem",{attrs:{label:"页面标题",prop:"title"}},[r("Input",{attrs:{placeholder:"文章标题"},model:{value:t.formItem.title,callback:function(e){t.$set(t.formItem,"title",e)},expression:"formItem.title"}})],1),t._v(" "),r("FormItem",{attrs:{label:"页面标识",prop:"slug"}},[r("Input",{attrs:{placeholder:"文章唯一标识，并作为参数构造url"},model:{value:t.formItem.slug,callback:function(e){t.$set(t.formItem,"slug",e)},expression:"formItem.slug"}})],1),t._v(" "),r("FormItem",{attrs:{label:"页面内容"}},[r("div",{attrs:{id:"editor"}},[r("mavon-editor",{ref:"md",staticClass:"editor",on:{imgAdd:t.imgAdd},model:{value:t.formItem.markdown,callback:function(e){t.$set(t.formItem,"markdown",e)},expression:"formItem.markdown"}})],1)]),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary"},on:{click:t.post}},[t._v("提交")])],1)],1)},staticRenderFns:[]},s=r("VU/8")(i,m,!1,null,null,null);e.default=s.exports}});
//# sourceMappingURL=10.f1365acd0baec03d1eed.js.map